{"ast":null,"code":"import React,{useEffect,useState}from'react';import ConfirmDialog from'./ConfirmDialog';import{updateBuyIn,deleteBuyIn,addCashOut}from'../api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TransactionHistoryDialog=_ref=>{let{open,gameId,player,onClose,refreshSummary}=_ref;const[editedBuyIns,setEditedBuyIns]=useState([]);const[editedCashOut,setEditedCashOut]=useState('');const[confirmEdit,setConfirmEdit]=useState({open:false,idx:null});const[confirmCash,setConfirmCash]=useState(false);// Reset local copies whenever dialog opens or player changes\nuseEffect(()=>{if(open&&player){var _player$cashOut;setEditedBuyIns(player.buyIns);setEditedCashOut((_player$cashOut=player.cashOut)!==null&&_player$cashOut!==void 0?_player$cashOut:'');}},[open,player]);// Guard after hooks are declared\nif(!open||!player)return null;const{name,buyIns,cashOut}=player;const handleBuyInChange=(idx,val)=>{const copy=[...editedBuyIns];copy[idx]=val;setEditedBuyIns(copy);};const saveBuyIn=async idx=>{const val=Number(editedBuyIns[idx]);if(val>0&&val!==buyIns[idx]){await updateBuyIn(gameId,name,idx,val);await refreshSummary();// Ensure local copy reflects any backend rounding/validation\nsetEditedBuyIns(prev=>{const cp=[...prev];cp[idx]=val;return cp;});}};const confirmAndSave=idx=>{const val=Number(editedBuyIns[idx]);if(val>0&&val!==buyIns[idx]){setConfirmEdit({open:true,idx});}};const saveCashOut=async()=>{const val=Number(editedCashOut);if(!isNaN(val)&&val>=0&&val!==cashOut){await addCashOut(gameId,{name,cashOut:val});refreshSummary();}};const handleCashOutChange=e=>{setEditedCashOut(e.target.value);};return/*#__PURE__*/_jsxs(\"div\",{className:\"confirm-overlay\",style:{zIndex:1000},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"confirm-dialog\",style:{width:'400px',maxHeight:'80vh',overflowY:'auto',position:'relative'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{position:'absolute',top:'0.5rem',right:'0.5rem',background:'none',border:'none',fontSize:'1.25rem',cursor:'pointer'},children:\"\\u2715\"}),/*#__PURE__*/_jsxs(\"h3\",{style:{marginTop:0},children:[\"Transaction History - \",name]}),/*#__PURE__*/_jsx(\"h4\",{children:\"Buy-Ins\"}),/*#__PURE__*/_jsx(\"ul\",{style:{listStyle:'none',padding:0},children:editedBuyIns.map((amt,idx)=>/*#__PURE__*/_jsxs(\"li\",{style:{display:'flex',alignItems:'center',gap:'0.5rem',margin:'0.25rem 0'},children:[/*#__PURE__*/_jsxs(\"span\",{children:[idx+1,\".\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:amt,min:\"0\",style:{width:'6rem'},onChange:e=>handleBuyInChange(idx,e.target.value)}),/*#__PURE__*/_jsx(\"button\",{disabled:Number(amt)<=0||Number(amt)===buyIns[idx],onClick:()=>confirmAndSave(idx),children:\"\\u2713\"}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{await deleteBuyIn(gameId,name,idx);refreshSummary();},children:\"\\uD83D\\uDDD1\\uFE0F\"})]},idx))}),/*#__PURE__*/_jsx(\"h4\",{style:{marginTop:'1rem'},children:\"Cash-Out\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'0.5rem'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:editedCashOut,min:\"0\",style:{width:'8rem'},onChange:handleCashOutChange}),/*#__PURE__*/_jsx(\"button\",{disabled:editedCashOut===''||Number(editedCashOut)===cashOut,onClick:()=>setConfirmCash(true),children:\"\\u2713\"})]})]}),/*#__PURE__*/_jsx(ConfirmDialog,{open:confirmEdit.open,message:\"Save changes to buy-in #\".concat(confirmEdit.idx!=null?confirmEdit.idx+1:'',\"?\"),confirmLabel:\"Save\",onCancel:()=>setConfirmEdit({open:false,idx:null}),onConfirm:async()=>{if(confirmEdit.idx!=null){await saveBuyIn(confirmEdit.idx);}setConfirmEdit({open:false,idx:null});}}),/*#__PURE__*/_jsx(ConfirmDialog,{open:confirmCash,message:\"Save changes to cash-out?\",confirmLabel:\"Save\",onCancel:()=>setConfirmCash(false),onConfirm:async()=>{await saveCashOut();setConfirmCash(false);}})]});};export default TransactionHistoryDialog;","map":{"version":3,"names":["React","useEffect","useState","ConfirmDialog","updateBuyIn","deleteBuyIn","addCashOut","jsx","_jsx","jsxs","_jsxs","TransactionHistoryDialog","_ref","open","gameId","player","onClose","refreshSummary","editedBuyIns","setEditedBuyIns","editedCashOut","setEditedCashOut","confirmEdit","setConfirmEdit","idx","confirmCash","setConfirmCash","_player$cashOut","buyIns","cashOut","name","handleBuyInChange","val","copy","saveBuyIn","Number","prev","cp","confirmAndSave","saveCashOut","isNaN","handleCashOutChange","e","target","value","className","style","zIndex","children","width","maxHeight","overflowY","position","onClick","top","right","background","border","fontSize","cursor","marginTop","listStyle","padding","map","amt","display","alignItems","gap","margin","type","min","onChange","disabled","message","concat","confirmLabel","onCancel","onConfirm"],"sources":["/Users/krishdembla/Desktop/poker-debt-app/webui/src/components/TransactionHistoryDialog.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport ConfirmDialog from './ConfirmDialog';\nimport { updateBuyIn, deleteBuyIn, addCashOut } from '../api';\n\nconst TransactionHistoryDialog = ({ open, gameId, player, onClose, refreshSummary }) => {\n\n  const [editedBuyIns, setEditedBuyIns] = useState([]);\n  const [editedCashOut, setEditedCashOut] = useState('');\n  const [confirmEdit, setConfirmEdit] = useState({ open: false, idx: null });\n  const [confirmCash, setConfirmCash] = useState(false);\n\n  // Reset local copies whenever dialog opens or player changes\n  useEffect(() => {\n    if (open && player) {\n      setEditedBuyIns(player.buyIns);\n      setEditedCashOut(player.cashOut ?? '');\n    }\n  }, [open, player]);\n\n  // Guard after hooks are declared\n  if (!open || !player) return null;\n\n  const { name, buyIns, cashOut } = player;\n\n  const handleBuyInChange = (idx, val) => {\n    const copy = [...editedBuyIns];\n    copy[idx] = val;\n    setEditedBuyIns(copy);\n  };\n\n  const saveBuyIn = async (idx) => {\n    const val = Number(editedBuyIns[idx]);\n    if (val > 0 && val !== buyIns[idx]) {\n      await updateBuyIn(gameId, name, idx, val);\n      await refreshSummary();\n      // Ensure local copy reflects any backend rounding/validation\n      setEditedBuyIns((prev) => {\n        const cp = [...prev];\n        cp[idx] = val;\n        return cp;\n      });\n    }\n  };\n\n  const confirmAndSave = (idx) => {\n    const val = Number(editedBuyIns[idx]);\n    if (val > 0 && val !== buyIns[idx]) {\n      setConfirmEdit({ open: true, idx });\n    }\n  };\n\n  const saveCashOut = async () => {\n    const val = Number(editedCashOut);\n    if (!isNaN(val) && val >= 0 && val !== cashOut) {\n      await addCashOut(gameId, { name, cashOut: val });\n      refreshSummary();\n    }\n  };\n\n  const handleCashOutChange = (e) => {\n    setEditedCashOut(e.target.value);\n  };\n\n\n  return (\n    <div className=\"confirm-overlay\" style={{ zIndex: 1000 }}>\n      <div className=\"confirm-dialog\" style={{ width: '400px', maxHeight: '80vh', overflowY: 'auto', position: 'relative' }}>\n        <button\n          onClick={onClose}\n          style={{ position: 'absolute', top: '0.5rem', right: '0.5rem', background: 'none', border: 'none', fontSize: '1.25rem', cursor: 'pointer' }}\n        >\n          ‚úï\n        </button>\n        <h3 style={{ marginTop: 0 }}>Transaction History - {name}</h3>\n\n        <h4>Buy-Ins</h4>\n        <ul style={{ listStyle: 'none', padding: 0 }}>\n          {editedBuyIns.map((amt, idx) => (\n            <li key={idx} style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', margin: '0.25rem 0' }}>\n              <span>{idx + 1}.</span>\n              <input\n                type=\"number\"\n                value={amt}\n                min=\"0\"\n                style={{ width: '6rem' }}\n                onChange={(e) => handleBuyInChange(idx, e.target.value)}\n              />\n              <button\n                disabled={Number(amt) <= 0 || Number(amt) === buyIns[idx]}\n                onClick={() => confirmAndSave(idx)}\n              >\n                ‚úì\n              </button>\n              <button\n                onClick={async () => {\n                  await deleteBuyIn(gameId, name, idx);\n                  refreshSummary();\n                }}\n              >\n                üóëÔ∏è\n              </button>\n            </li>\n          ))}\n        </ul>\n\n        <h4 style={{ marginTop: '1rem' }}>Cash-Out</h4>\n        <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          <input\n            type=\"number\"\n            value={editedCashOut}\n            min=\"0\"\n            style={{ width: '8rem' }}\n            onChange={handleCashOutChange}\n          />\n          <button\n            disabled={editedCashOut === '' || Number(editedCashOut) === cashOut}\n            onClick={() => setConfirmCash(true)}\n          >\n            ‚úì\n          </button>\n        </div>\n      </div>\n\n      <ConfirmDialog\n        open={confirmEdit.open}\n        message={`Save changes to buy-in #${confirmEdit.idx != null ? confirmEdit.idx + 1 : ''}?`}\n        confirmLabel=\"Save\"\n        onCancel={() => setConfirmEdit({ open: false, idx: null })}\n        onConfirm={async () => {\n          if (confirmEdit.idx != null) {\n            await saveBuyIn(confirmEdit.idx);\n          }\n          setConfirmEdit({ open: false, idx: null });\n        }}\n      />\n\n      <ConfirmDialog\n        open={confirmCash}\n        message=\"Save changes to cash-out?\"\n        confirmLabel=\"Save\"\n        onCancel={() => setConfirmCash(false)}\n        onConfirm={async () => {\n          await saveCashOut();\n          setConfirmCash(false);\n        }}\n      />\n    </div>\n  );\n};\n\nexport default TransactionHistoryDialog;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}